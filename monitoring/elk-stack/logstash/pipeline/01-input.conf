# Logstash Input Configuration for SentientEdge
# Handles multiple input sources for comprehensive log collection

input {
  # Filebeat input for structured logs
  beats {
    port => 5044
    codec => json_lines
  }

  # TCP input for real-time application logs
  tcp {
    port => 5000
    codec => json_lines
    tags => ["tcp", "application"]
  }

  # File input for direct log file reading
  file {
    path => "/var/log/sentient-edge/*.log"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/sincedb_main"
    codec => json_lines
    tags => ["file", "application"]
  }

  # File input for audit logs
  file {
    path => "/var/log/sentient-edge/audit/*.log"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/sincedb_audit"
    codec => json_lines
    tags => ["file", "audit"]
  }

  # File input for security logs
  file {
    path => "/var/log/sentient-edge/security/*.log"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/sincedb_security"
    codec => json_lines
    tags => ["file", "security"]
  }

  # File input for metrics logs
  file {
    path => "/var/log/sentient-edge/metrics/*.log"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/sincedb_metrics"
    codec => json_lines
    tags => ["file", "metrics"]
  }

  # HTTP input for webhook-based log delivery
  http {
    port => 8080
    codec => json_lines
    tags => ["http", "webhook"]
  }

  # UDP input for high-frequency telemetry data
  udp {
    port => 5514
    codec => json_lines
    tags => ["udp", "telemetry"]
  }
}